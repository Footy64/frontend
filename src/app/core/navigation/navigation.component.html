<header class="app-nav">
  <div class="app-nav__bar">
    <a class="app-nav__brand" routerLink="/" (click)="closeMenu()">
      <span class="app-nav__logo">F</span>
      <div class="app-nav__brand-copy">
        <span>Footy</span>
        <small>club control room</small>
      </div>
    </a>

    <nav class="app-nav__links" aria-label="Navigation principale">
      <ng-container *ngIf="isAuthenticated$ | async; else guestDesktopLinks">
        <a
          class="app-nav__link"
          routerLink="/dashboard"
          routerLinkActive="app-nav__link--active"
          [routerLinkActiveOptions]="{ exact: true }"
          (click)="closeMenu()"
          >Vue d'ensemble</a
        >
        <a
          class="app-nav__link"
          routerLink="/dashboard/teams"
          routerLinkActive="app-nav__link--active"
          (click)="closeMenu()"
          >Equipes</a
        >
        <a
          class="app-nav__link"
          routerLink="/dashboard/matches"
          routerLinkActive="app-nav__link--active"
          (click)="closeMenu()"
          >Matchs</a
        >
      </ng-container>
    </nav>

    <div class="app-nav__actions">
      <ng-container *ngIf="isAuthenticated$ | async; else guestDesktopActions">
        <span class="app-nav__pill" *ngIf="user$ | async as user">
          {{ user.displayName || user.email }}
        </span>
        <button class="app-nav__button app-nav__button--ghost" type="button" (click)="logout()">
          Se deconnecter
        </button>
      </ng-container>
    </div>

    <button class="app-nav__menu" type="button" (click)="toggleMenu()">
      <span class="sr-only">Ouvrir le menu</span>
      <span *ngIf="!isMenuOpen">&#9776;</span>
      <span *ngIf="isMenuOpen">&#10005;</span>
    </button>
  </div>

  <section *ngIf="isMenuOpen" class="app-nav__drawer" aria-label="Navigation mobile">
    <ng-container *ngIf="isAuthenticated$ | async; else guestMobile">
      <div class="app-nav__drawer-panel">
        <div class="app-nav__drawer-user" *ngIf="user$ | async as user">
          <p class="app-nav__drawer-label">Connecte</p>
          <strong>{{ user.displayName || user.email }}</strong>
        </div>
        <a
          class="app-nav__drawer-link"
          routerLink="/dashboard"
          [routerLinkActiveOptions]="{ exact: true }"
          routerLinkActive="app-nav__drawer-link--active"
          (click)="closeMenu()"
          >Vue d'ensemble</a
        >
        <a
          class="app-nav__drawer-link"
          routerLink="/dashboard/teams"
          routerLinkActive="app-nav__drawer-link--active"
          (click)="closeMenu()"
          >Equipes</a
        >
        <a
          class="app-nav__drawer-link"
          routerLink="/dashboard/matches"
          routerLinkActive="app-nav__drawer-link--active"
          (click)="closeMenu()"
          >Matchs</a
        >
        <button class="app-nav__drawer-logout" type="button" (click)="logout()">
          Se deconnecter
        </button>
      </div>
    </ng-container>
  </section>

  <ng-template #guestDesktopLinks>
    <a
      class="app-nav__link"
      routerLink="/"
      [routerLinkActiveOptions]="{ exact: true }"
      routerLinkActive="app-nav__link--active"
      (click)="closeMenu()"
      >Accueil</a
    >
    <a
      class="app-nav__link"
      routerLink="/auth/login"
      routerLinkActive="app-nav__link--active"
      (click)="closeMenu()"
      >Connexion</a
    >
    <a
      class="app-nav__link"
      routerLink="/auth/register"
      routerLinkActive="app-nav__link--active"
      (click)="closeMenu()"
      >Inscription</a
    >
  </ng-template>

  <ng-template #guestDesktopActions>
    <a class="app-nav__button app-nav__button--ghost" routerLink="/auth/login" (click)="closeMenu()">
      Se connecter
    </a>
    <a class="app-nav__button app-nav__button--solid" routerLink="/auth/register" (click)="closeMenu()">
      Rejoindre Footy
    </a>
  </ng-template>

  <ng-template #guestMobile>
    <div class="app-nav__drawer-panel">
      <p class="app-nav__drawer-label">Demarrer</p>
      <a
        class="app-nav__drawer-link"
        routerLink="/"
        [routerLinkActiveOptions]="{ exact: true }"
        routerLinkActive="app-nav__drawer-link--active"
        (click)="closeMenu()"
        >Accueil</a
      >
      <a
        class="app-nav__drawer-link"
        routerLink="/auth/login"
        routerLinkActive="app-nav__drawer-link--active"
        (click)="closeMenu()"
        >Connexion</a
      >
      <a
        class="app-nav__drawer-link app-nav__drawer-link--highlight"
        routerLink="/auth/register"
        routerLinkActive="app-nav__drawer-link--active"
        (click)="closeMenu()"
        >Inscription</a
      >
    </div>
  </ng-template>
</header>
